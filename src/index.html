<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Angular</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
  <app-root></app-root>
  
  <h1>Create Event</h1>

  <div class="grid">
    <div>
      <label for="names">Name:</label>
    <select name="names" id="names">
      <option value="Aaron McQuade">Aaron McQuade</option>
      <option value="Alex Fudge">Alex Fudge</option>
      <option value="Andrew Dunlop">Andrew Dunlop</option>
      <option value="Andrew Lebert">Andrew Lebert</option>
      <option value="Andrew Smith">Andrew Smith</option>
      <option value="Anthony Walsh">Anthony Walsh</option>
      <option value="Bethany McCulloh">Bethany McCulloh</option>
      <option value="Brad Pilon">Brad Pilon</option>
      <option value="Corey Graveline-Dumouchel">Corey Graveline-Dumouchel</option>
      <option value="David Priebe">David Priebe</option>
      <option value="Dean Cybulski">Dean Cybulski</option>
      <option value="Don White">Don White</option>
      <option value="Gavin McGinley">Gavin McGinley</option>
      <option value="Josh Burton">Josh Burton</option>
      <option value="Justin Lepine">Justin Lepine</option>
      <option value="Kathy Prescott">Kathy Prescott</option>
      <option value="Matt Beres">Matt Beres</option>
      <option value="Michelle Rowe">Michelle Rowe</option>
      <option value="Mitch Yackobeck">Mitch Yackobeck</option>
      <option value="Sheri Larochelle">Sheri Larochelle</option>
      <option value="Terri Lee">Terri Lee</option>
      <option value="Trevor Smith">Trevor Smith</option>
    </select>
  </div>
    
  <div>
    <label for="date">Day:</label>
    <input type="date" id="date" name="date">
  </div>

  <div>
    <label for="eventTypes">Event type:</label>
    <select name="eventTypes" id="eventTypes" onchange="handleEventTypeChange()">
      <option value="Conference">Conference</option>
      <option value="Field">Field</option>
      <option value="Out of Office">Out of Office</option>
    </select>
  </div>

    <div>
      <label for="allDay">All day?</label>
      <input type="checkbox" id="allDay" name="allDay" value="allDay" checked onchange="handleAllDayChange()">
    </div>

    <div class="schools" id="locations" style="visibility: hidden;">
      <label><input type="checkbox" name="ADH" id="ADH" value="ADH"> ADH</label>
      <label><input type="checkbox" name="ADM" id="ADM" value="ADM"> ADM</label>
      <label><input type="checkbox" name="AJC" id="AJC" value="AJC"> AJC</label>
      <label><input type="checkbox" name="BCH" id="BCH" value="BCH"> BCH</label>
      <label><input type="checkbox" name="CEN" id="CEN" value="CEN"> CEN</label>
      <label><input type="checkbox" name="CDS" id="CDS" value="CDS"> CDS</label>
      <label><input type="checkbox" name="COB" id="COB" value="COB"> COB</label>
      <label><input type="checkbox" name="EGN" id="EGN" value="EGN"> EGN</label>
      <label><input type="checkbox" name="FHS" id="FHS" value="FHS"> FHS</label>
      <label><input type="checkbox" name="HRM" id="HRM" value="HRM"> HRM</label>
      <label><input type="checkbox" name="HVW" id="HVW" value="HVW"> HVW</label>
      <label><input type="checkbox" name="KIL" id="KIL" value="KIL"> KIL</label>
      <label><input type="checkbox" name="MCS" id="MCS" value="MCS"> MCS</label>
      <label><input type="checkbox" name="MCN" id="MCN" value="MCN"> MCN</label>
      <label><input type="checkbox" name="MHS" id="MHS" value="MHS"> MHS</label>
      <label><input type="checkbox" name="MVD" id="MVD" value="MVD"> MVD</label>
      <label><input type="checkbox" name="OHS" id="OHS" value="OHS"> OHS</label>
      <label><input type="checkbox" name="PAL" id="PAL" value="PAL"> PAL</label>
      <label><input type="checkbox" name="PVW" id="PVW" value="PVW"> PVW</label>
      <label><input type="checkbox" name="QEL" id="QEL" value="QEL"> QEL</label>
      <label><input type="checkbox" name="RCA" id="RCA" value="RCA"> RCA</label>
      <label><input type="checkbox" name="RCI" id="RCI" value="RCI"> RCI</label>
      <label><input type="checkbox" name="RCIS" id="RCIS" value="RCIS"> RCIS</label>
      <label><input type="checkbox" name="RCK" id="RCK" value="RCK"> RCK</label>
      <label><input type="checkbox" name="VAL" id="VAL" value="VAL"> VAL</label>
      <label><input type="checkbox" name="WPS" id="WPS" value="WPS"> WPS</label>
      <label><input type="checkbox" name="WZD" id="WZD" value="WZD"> WZD</label>
    </div>

    <div id="time" class="time">
      <label for="startTime">Start time:</label>
      <input type="time" id="startTime" name="startTime" value="12:00"> <br/>
      <label for="endTime">End time:</label>
      <input type="time" id="endTime" name="endTime" value="13:00">
    </div>

  </div>


  <button id="authorize_button" onclick="handleAuthClick()">Submit</button>




  <pre id="content" style="white-space: pre-wrap;"></pre>

  <script type="text/javascript">
    /* exported gapiLoaded */
    /* exported gisLoaded */
    /* exported handleAuthClick */
    /* exported handleSignoutClick */

    // TODO(developer): Set to client ID and API key from the Developer Console
    const CLIENT_ID = '867495649327-osufd5ti5dnkjan5ea7krse983r776t3.apps.googleusercontent.com';
    const API_KEY = 'AIzaSyDi7hRaUZ5OdAyVQdwRdxf-EJro2igCp2Q';

    // Discovery doc URL for APIs used by the quickstart
    const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest';

    // Authorization scopes required by the API; multiple scopes can be
    // included, separated by spaces.
    const SCOPES = 'https://www.googleapis.com/auth/calendar';

    let tokenClient;
    let gapiInited = false;
    let gisInited = false;

    document.getElementById('authorize_button').style.visibility = 'hidden';

    /**
     * Callback after api.js is loaded.
     */
    function gapiLoaded() {
      gapi.load('client', initializeGapiClient);
    }

    /**
     * Callback after the API client is loaded. Loads the
     * discovery doc to initialize the API.
     */
    async function initializeGapiClient() {
      await gapi.client.init({
        apiKey: API_KEY,
        discoveryDocs: [DISCOVERY_DOC],
      });
      gapiInited = true;
      maybeEnableButtons();
    }

    /**
     * Callback after Google Identity Services are loaded.
     */
    function gisLoaded() {
      tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: SCOPES,
        callback: '', // defined later
      });
      gisInited = true;
      maybeEnableButtons();
    }

    /**
     * Enables user interaction after all libraries are loaded.
     */
    function maybeEnableButtons() {
      if (gapiInited && gisInited) {
        document.getElementById('authorize_button').style.visibility = 'visible';
      }
    }

    /**
     *  Sign in the user upon button click.
     */
    function handleAuthClick() {
      tokenClient.callback = async (resp) => {
        if (resp.error !== undefined) {
          throw (resp);
        }
        addEvent();
      };

      if (gapi.client.getToken() === null) {
        // Prompt the user to select a Google Account and ask for consent to share their data
        // when establishing a new session.
        tokenClient.requestAccessToken({prompt: 'consent'});
      } else {
        // Skip display of account chooser and consent dialog for an existing session.
        tokenClient.requestAccessToken({prompt: ''});
      }
    }

    /**
     *  Sign out the user upon button click.
     */
    function handleSignoutClick() {
      const token = gapi.client.getToken();
      if (token !== null) {
        google.accounts.oauth2.revoke(token.access_token);
        gapi.client.setToken('');
        document.getElementById('content').innerText = '';
        document.getElementById('authorize_button').innerText = 'Authorize';
        document.getElementById('signout_button').style.visibility = 'hidden';
      }
    }

    /**
     * Print the summary and start datetime/date of the next ten events in
     * the authorized user's calendar. If no events are found an
     * appropriate message is printed.
     */
    

    function addEvent() {
      const event = {
          summary: document.getElementById('names').value + ' - ' + document.getElementById('eventTypes').value,
          description: '',
          start: {
            dateTime: document.getElementById('allDay').checked ? null : document.getElementById('date').value + 'T' + document.getElementById('startTime').value + ':00-04:00',
            date: document.getElementById('allDay').checked ? document.getElementById('date').value : null
          },
          end: {
            dateTime: document.getElementById('allDay').checked == true ? null : document.getElementById('date').value + 'T' + document.getElementById('endTime').value + ':00-04:00',
            date: document.getElementById('allDay').checked == true ? document.getElementById('date').value : null
          },
          attendees: [],
          reminders: {
          },
        };

      const request = gapi.client.calendar.events.insert({
        calendarId: 'c_f049b179cd81305d0df146197f30755153a65542312c9c86ad719559138b61c6@group.calendar.google.com',
        resource: event,
      });

      request.execute(function(event) {
        console.log('Event created: ' + event.htmlLink);
      });
    }

    function handleEventTypeChange() {
      const eventType = document.getElementById('eventTypes').value;
      if (eventType == "Field") {
        document.getElementById('locations').style.visibility = 'visible';
      } else {
        document.getElementById('locations').style.visibility = 'hidden';
      }
    
    }

    function handleAllDayChange() {
      const allDay = document.getElementById('allDay').checked;
      if (allDay) {
        document.getElementById('time').style.visibility = 'hidden';
      } else {
        document.getElementById('time').style.visibility = 'visible';
      }
    }
  </script>
  <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
  <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</body>
</html>
